# steelsurfacedefectdetection
##Steel Surface Defect Detection - Semantic Segmentation for Steel Defect Detection with U-NET

**Purpose –** The technique of segmentation has become an active research process in the field of computer vision. The use has also grown into a popular approach in agricultural, construction, transportation, medical image processing etc. The goal of segmentation is to label each pixel of an image with a corresponding class and to produce a corresponding mask which identifies the exact boundary of the objects in the image. In this research, we aim to explore different deep learning approaches of detecting defects on steel sheet surfaces, then output the same-size segmented images with defected area with the help of U-Net.

**Design/methodology/approach –** The dataset was taken from Kaggle: Severstal: Steel Defect Detection. The dataset contains 12,568 digital photos taken by high-frequency cameras, of steel sheet surface with four types of defects: type 1: little black dots caused by potting/vertical black 	lines; type 2: vertical black lines near edges; type 3: vertical scratches of black lines/large 	abrasions; type 4: large blotches, as well as images of undamaged surfaces.  Our networks and training strategies relied on the strong use of data augmentation to use the available samples more efficiently. All images were RGB images with 256x1600 pixels. Training images and testing images were 256x400 pixels in size. We had broken the experiments down to three major steps: (1) Binary classification; (2) Multi-label classification; (3) Segmentation. Both InceptionV3 and Xception models pre-trained on ImageNet were used at this stage. In order to optimize the models, we trained both of the models with different learning rate configurations: (1) Exponential Decay with SGD; (2) Cosine Annealing with SGD; (3) Adaptive Learning Rates with Adam. Models were trained for 30 epochs with a batch size of 8. For multi-label classification, images without defects were removed. Similar to the binary classification, both InceptionV3 model and Xception model were trained with three learning rate configurations.

In order to find out the most efficient model for the segmentation problem, this study has explored two segmentation approaches: (1) Binary segmentation method; (2) Multi-class segmentation method. Based on these two methods, three model structures were proposed: (1) U-Net with ResNet encoder (Binary segmentation); (2) FPN-U-Net with Fusion Modules (Binary segmentation); (3) U-Net with ResNet encoder (Multi-class segmentation). Also, Tversky Index was used as our evaluation metric, and we had tried out three different loss functions were  (1) Focal Loss; (2) Weighted Focal Loss; (3) Focal Tversky Loss (FTL), in order to obtain the best segmentation model.

**Findings –** The experimental results revealed that the best proposed binary classifier had yielded an accuracy of 96.5% with 0.5 as the thresholding value, and the best proposed multi-class classifier had yielded the class accuracies as: 96.32%, 98.53%, 90.84%, and 97.58%, with [0.7, 0.7, 0.8, 0.8] as thresholding values for each type of defects. The best results obtained from the proposed segmentation model based on dice coefficient values were:  74.36%, 87.74%, 77.45%, and 82.00%, for type 1-4 defect respectively, with an overall dice coefficient value as 70.60%. 

**Originality/values –** We would like to find out the most efficient and accurate model for this specific problem. Furthermore, the models would also be able to detect defects on the surface of other materials, such as concrete, textile and wood etc. We hope to apply this detection method to locate the structural cracks for infrastructure (railways, buildings, bridges etc.) to improve safety of the structures.
